<!-- Mon tableau de gestion de tÃ¢ches personnalisÃ© -->
<div class="board-container">
    <h1>Mon Tableau de TÃ¢ches</h1>
    
    <!-- Formulaire d'ajout de tÃ¢che -->
    <div class="add-task-form">
        <form id="todo-form" method="POST">
            <div class="form-group">
                <input
                    type="text"
                    id="todo-input"
                    name="title"
                    placeholder="Quelle est votre nouvelle tÃ¢che ?"
                    required
                />
                <div id="error-titre" class="error-message"></div>
            </div>
            <div class="form-group">
                <textarea
                    id="todo-description"
                    name="description"
                    placeholder="DÃ©crivez votre tÃ¢che en quelques mots..."
                    rows="3"
                ></textarea>
                <div id="error-description" class="error-message"></div>
            </div>
            <div class="form-group">
                <select id="todo-priority" name="priority" required>
                    <option value="Faible">PrioritÃ© Faible</option>
                    <option value="Moyenne" selected>PrioritÃ© Moyenne</option>
                    <option value="Ã‰levÃ©e">PrioritÃ© Ã‰levÃ©e</option>
                </select>
                <div id="error-priorite" class="error-message"></div>
            </div>
            <div class="form-group">
                <input
                    type="datetime-local"
                    id="todo-due-date"
                    name="dueDate"
                    required
                />
                <div id="error-date" class="error-message"></div>
            </div>
            <div class="form-group">
                <input
                    type="text"
                    id="todo-assigned-to"
                    name="assignedTo"
                    placeholder="Qui est responsable de cette tÃ¢che ?"
                />
                <div id="error-assigne" class="error-message"></div>
            </div>
            <div class="form-group">
                <select id="todo-status" name="status" required>
                    <option value="A faire" selected>Ã€ Faire</option>
                    <option value="En cours">En Cours</option>
                    <option value="En revision">En RÃ©vision</option>
                    <option value="Terminee">TerminÃ©e</option>
                </select>
                <div id="error-statut" class="error-message"></div>
            </div>
            <div class="form-group">
                <button type="submit">CrÃ©er la TÃ¢che</button>
            </div>
        </form>
    </div>

    <!-- Mon tableau de tÃ¢ches -->
    <div class="board">
        <!-- Colonne Ã€ Faire -->
        <div class="column">
            <h2>Ã€ Faire</h2>
            <ul class="task-list" data-status="A faire">
                {{#each todos}}
                    {{#if (eq this.status "A faire")}}
                        <li class="todo-item" draggable="true" data-id="{{this.id}}">
                            <div class="card-content">
                                <h3 class="title">{{this.title}}</h3>
                                <p class="description">{{this.description}}</p>
                                <div class="task-details">
                                    <span class="priority priority-{{toLowerCase this.priority}}">{{this.priority}}</span>
                                    {{#if this.dueDate}}
                                        <span class="due-date">ðŸ“… {{formatDate this.dueDate}}</span>
                                    {{/if}}
                                    {{#if this.assignedTo}}
                                        <span class="assigned-to">ðŸ‘¤ {{this.assignedTo}}</span>
                                    {{/if}}
                                </div>
                                <div class="task-actions">
                                    <button class="history-btn" type="button" aria-label="Voir l'historique" data-id="{{this.id}}">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="delete-btn" type="button" aria-label="Supprimer la tÃ¢che" data-id="{{this.id}}">Ã—</button>
                                </div>
                            </div>
                        </li>
                    {{/if}}
                {{/each}}
            </ul>
        </div>

        <!-- Colonne En Cours -->
        <div class="column">
            <h2>En Cours</h2>
            <ul class="task-list" data-status="En cours">
                {{#each todos}}
                    {{#if (eq this.status "En cours")}}
                        <li class="todo-item" draggable="true" data-id="{{this.id}}">
                            <div class="card-content">
                                <h3 class="title">{{this.title}}</h3>
                                <p class="description">{{this.description}}</p>
                                <div class="task-details">
                                    <span class="priority priority-{{toLowerCase this.priority}}">{{this.priority}}</span>
                                    {{#if this.dueDate}}
                                        <span class="due-date">ðŸ“… {{formatDate this.dueDate}}</span>
                                    {{/if}}
                                    {{#if this.assignedTo}}
                                        <span class="assigned-to">ðŸ‘¤ {{this.assignedTo}}</span>
                                    {{/if}}
                                </div>
                                <div class="task-actions">
                                    <button class="history-btn" type="button" aria-label="Voir l'historique" data-id="{{this.id}}">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="delete-btn" type="button" aria-label="Supprimer la tÃ¢che" data-id="{{this.id}}">Ã—</button>
                                </div>
                            </div>
                        </li>
                    {{/if}}
                {{/each}}
            </ul>
        </div>

        <!-- Colonne En RÃ©vision -->
        <div class="column">
            <h2>En RÃ©vision</h2>
            <ul class="task-list" data-status="En revision">
                {{#each todos}}
                    {{#if (eq this.status "En revision")}}
                        <li class="todo-item" draggable="true" data-id="{{this.id}}">
                            <div class="card-content">
                                <h3 class="title">{{this.title}}</h3>
                                <p class="description">{{this.description}}</p>
                                <div class="task-details">
                                    <span class="priority priority-{{toLowerCase this.priority}}">{{this.priority}}</span>
                                    {{#if this.dueDate}}
                                        <span class="due-date">ðŸ“… {{formatDate this.dueDate}}</span>
                                    {{/if}}
                                    {{#if this.assignedTo}}
                                        <span class="assigned-to">ðŸ‘¤ {{this.assignedTo}}</span>
                                    {{/if}}
                                </div>
                                <div class="task-actions">
                                    <button class="history-btn" type="button" aria-label="Voir l'historique" data-id="{{this.id}}">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="delete-btn" type="button" aria-label="Supprimer la tÃ¢che" data-id="{{this.id}}">Ã—</button>
                                </div>
                            </div>
                        </li>
                    {{/if}}
                {{/each}}
            </ul>
        </div>

        <!-- Colonne TerminÃ©e -->
        <div class="column">
            <h2>TerminÃ©e</h2>
            <ul class="task-list" data-status="Terminee">
                {{#each todos}}
                    {{#if (eq this.status "Terminee")}}
                        <li class="todo-item" draggable="true" data-id="{{this.id}}">
                            <div class="card-content">
                                <h3 class="title">{{this.title}}</h3>
                                <p class="description">{{this.description}}</p>
                                <div class="task-details">
                                    <span class="priority priority-{{toLowerCase this.priority}}">{{this.priority}}</span>
                                    {{#if this.dueDate}}
                                        <span class="due-date">ðŸ“… {{formatDate this.dueDate}}</span>
                                    {{/if}}
                                    {{#if this.assignedTo}}
                                        <span class="assigned-to">ðŸ‘¤ {{this.assignedTo}}</span>
                                    {{/if}}
                                </div>
                                <div class="task-actions">
                                    <button class="history-btn" type="button" aria-label="Voir l'historique" data-id="{{this.id}}">
                                        <i class="fas fa-history"></i>
                                    </button>
                                    <button class="delete-btn" type="button" aria-label="Supprimer la tÃ¢che" data-id="{{this.id}}">Ã—</button>
                                </div>
                            </div>
                        </li>
                    {{/if}}
                {{/each}}
            </ul>
        </div>
    </div>
</div>

<!-- FenÃªtre modale pour l'historique -->
<div id="history-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Historique des Modifications</h2>
            <button class="close-modal">&times;</button>
        </div>
        <div id="history-list" class="history-list">
            <!-- Le contenu sera injectÃ© dynamiquement par JavaScript -->
        </div>
    </div>
</div>

<script src="/js/history.js"></script>
